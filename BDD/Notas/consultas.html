<!DOCTYPE html>
<html lang="es">
<head>
<!-- 2022-03-23 Wed 17:52 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Consultas SQL</title>
<meta name="author" content="Alberto Robles Gomez" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="../../css/index.css" />
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Consultas SQL</h1>
</header><ol class="org-ol">
<li><p>
Titulo de las peliculas producidas despues del año 2005
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt; 2005;
</pre>
</div></li>

<li><p>
Precio y formato de las peliculas de menos de 1 euro
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> precio, formato
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio &lt; 1;
</pre>
</div></li>

<li><p>
Titulo de las peliculas en formato DVD
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato = <span class="org-string">'DVD'</span>;
</pre>
</div></li>

<li><p>
Listado con los formetos de las peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> formato
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Cuantas peliculas se produjeron en los 3 ultimos años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt;= 2019;
</pre>
</div></li>

<li><p>
Cuantos DVDs estan de oferta
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  oferta = <span class="org-string">'S'</span> <span class="org-keyword">AND</span> formato = <span class="org-string">'DVD'</span>;
</pre>
</div></li>

<li><p>
Precio mas caro de una pelicula
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(precio)
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Año de la pelicula mas antigua
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span>(anno)
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Cuantas peliculas no estan en MP4
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato != <span class="org-string">'MP4'</span>;
</pre>
</div></li>

<li><p>
Titulo de las peliculas que empiezan por 'M'
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'M%'</span>;
</pre>
</div></li>

<li><p>
Cuantos titulos de peliculas estan formados por mas de una palabra
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'% %'</span>;
</pre>
</div></li>

<li><p>
Cuantas peliculas se han alquilado en Febrero
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  FECHA <span class="org-keyword">LIKE</span> <span class="org-string">'__/02/%'</span>;
</pre>
</div></li>

<li><p>
Codigo de los socios que no han devuelto las pelis que alquilaron
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  devuelta = <span class="org-string">'N'</span>;
</pre>
</div></li>

<li><p>
Nombre de los socios que presublimenete son chicas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  nombre <span class="org-keyword">LIKE</span> <span class="org-string">'%a'</span>;
</pre>
</div></li>

<li><p>
Que titulos de peliculas no estan ni en DVD ni en MP4
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato != <span class="org-string">'DVD'</span>
  <span class="org-keyword">AND</span>  formato != <span class="org-string">'MP4'</span>;
</pre>
</div></li>

<li><p>
Cuantas peliculas hay de matrix
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'Matrix%'</span>;
</pre>
</div></li>

<li><p>
Cuantas peliculas se alquilaron en febrero de 2002
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/02/02'</span>;
</pre>
</div></li>

<li><p>
Nombre de nuestros socios que presumiblemente son chicas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  nombre <span class="org-keyword">LIKE</span> <span class="org-string">'%a'</span>;
</pre>
</div></li>

<li><p>
Código de los socios que en el 2005 no nos devolvieron las
peliculas alquiladas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/__/05'</span>
  <span class="org-keyword">AND</span>  devuelta = <span class="org-string">'N'</span>;
</pre>
</div></li>

<li><p>
Precio de la película mas cara
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(precio)
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Nombre de paises que tienen menos de 7 letras
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre_pais
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  <span class="org-keyword">LENGTH</span>(nombre_pais) &lt; 7;
</pre>
</div></li>

<li><p>
Visualiza los distintos formatos de las películas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> formato
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Título de las pelis que valen 2 euros o 2 euros y pico
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio &gt;= 2
  <span class="org-keyword">AND</span>  precio &lt; 3;
</pre>
</div></li>

<li><p>
En qué año se produjo la primera película
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span>(anno)
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Título de las películas que se han producido en los últimos 10
años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt; TO_CHAR(
         ADD_MONTHS(SYSDATE, -12*10),
         <span class="org-string">'YYYY'</span>
       );
</pre>
</div></li>

<li><p>
Precio medio de los dvds
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">AVG</span>(precio)
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Cuato valen todos los DVDs que tenemos
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(precio)
<span class="org-keyword">FROM</span>   peliculas;
</pre>
</div></li>

<li><p>
Cuantos cines existen entre España, Francia y Portugal
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(cines)
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  nombre_pais <span class="org-keyword">in</span> ( <span class="org-string">'Espa&#241;a'</span>, <span class="org-string">'Francia'</span>, <span class="org-string">'Portugal'</span> );
</pre>
</div></li>

<li><p>
Cuanto valen todas las peliculas que no están ni en BR ni en MP4
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(precio)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  <span class="org-keyword">NOT</span> formato = <span class="org-string">'BR'</span>
  <span class="org-keyword">AND</span>  <span class="org-keyword">NOT</span> formato = <span class="org-string">'MP4'</span>;
</pre>
</div></li>

<li><p>
Precio mas caro de una pelicula en oferta
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(precio)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  oferta = <span class="org-string">'S'</span>;
</pre>
</div></li>

<li><p>
Cuantos socios son de Toledo
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  telefono <span class="org-keyword">LIKE</span> <span class="org-string">'925%'</span>;
</pre>
</div></li>

<li><p>
Cual es la facturación total del 2º semestre de 2002
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(precio)
<span class="org-keyword">FROM</span>   peliculas, alquiler
<span class="org-keyword">WHERE</span>  SUBSTR(fecha, 4, 2) &gt; 6
  <span class="org-keyword">AND</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/__/02'</span>;
</pre>
</div></li>

<li><p>
Que codigos de socio alquilan películas en Enero
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">LIKE</span> <span class="org-string">'__/01/__'</span>;
</pre>
</div></li>

<li><p>
Cuanto dinero se ha gastado el socio de código 1001
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(precio)
<span class="org-keyword">FROM</span>   alquiler, peliculas
<span class="org-keyword">WHERE</span>  c_socio = 1001;
</pre>
</div></li>

<li><p>
Visualizar los paises de más de 8000 cines ordenados
alfabeticamente
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   nombre_pais
<span class="org-keyword">FROM</span>     paises
<span class="org-keyword">WHERE</span>    cines &gt; 8000
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre_pais;
</pre>
</div></li>

<li><p>
Cuantas veces se ha alquilado la pelicula de codigo 2
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  c_peli = 2;
</pre>
</div></li>

<li><p>
Nombre de los hermanos de Gema Ramirez Lopez
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  ape1 = <span class="org-string">'ramirez'</span>
  <span class="org-keyword">AND</span>  ape2 = <span class="org-string">'lopez'</span>
  <span class="org-keyword">AND</span>  <span class="org-keyword">NOT</span> nombre = <span class="org-string">'gema'</span>;
</pre>
</div></li>

<li><p>
Despues del 2000 en cuantos años no se han producido peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> SUBSTR(SYSDATE, 7, 2)
       - <span class="org-builtin">COUNT</span>(<span class="org-keyword">DISTINCT</span> anno)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno &gt; 2000;
</pre>
</div></li>

<li><p>
Visualiza en que años se han alquilado peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> SUBSTR(fecha, 7, 2)
<span class="org-keyword">FROM</span>   alquiler;
</pre>
</div></li>

<li><p>
Cuantas peliculas hay de Tiburon
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'Tibur&#243;n%'</span>;
</pre>
</div></li>

<li><p>
Cuantos alquileres de un solo dia no se han devuelto
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  ndias = 1
  <span class="org-keyword">AND</span>  devuelta = <span class="org-string">'N'</span>;
</pre>
</div></li>

<li><p>
Cuantos socios viven en la calle oro
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  direccion <span class="org-keyword">LIKE</span> <span class="org-string">'oro,%'</span>;
</pre>
</div></li>

<li><p>
Que titulo de peliculas es la mas cara
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio = (<span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(precio) <span class="org-keyword">FROM</span> peliculas);
</pre>
</div></li>

<li><p>
Cual es el titulo de la pelicula mas moderna
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  anno = (<span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(anno) <span class="org-keyword">FROM</span> PELICULAS);
</pre>
</div></li>

<li><p>
En que formato esta la pelicula mas barata
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> formato
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  precio = (<span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span>(precio) <span class="org-keyword">FROM</span> PELICULAS);
</pre>
</div></li>

<li><p>
Cuando se hizo el ultimo alquiler
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(fecha)
<span class="org-keyword">FROM</span>   alquiler;
</pre>
</div></li>

<li><p>
Cual es el pais que tiene mas cines
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre_pais
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  cines = (<span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(cines) <span class="org-keyword">FROM</span> paises);
</pre>
</div></li>

<li><p>
Titulo de las peliculas españolas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  c_pais = (
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  nombre_pais = <span class="org-string">'Espa&#241;a'</span>
       );
</pre>
</div></li>

<li><p>
Titulo de las peliculas que no se alquilan
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> <span class="org-keyword">DISTINCT</span> c_peli
         <span class="org-keyword">FROM</span> alquiler
       );
</pre>
</div></li>

<li><p>
Nombre de los hermanos de Laura.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  ape1 = (
         <span class="org-keyword">SELECT</span> ape1
         <span class="org-keyword">FROM</span>   socios
         <span class="org-keyword">WHERE</span>  nombre = <span class="org-string">'laura'</span>
       )
  <span class="org-keyword">AND</span>  ape2 = (
         <span class="org-keyword">SELECT</span> ape2
         <span class="org-keyword">FROM</span>   socios
         <span class="org-keyword">WHERE</span>  nombre = <span class="org-string">'laura'</span>
       )
  <span class="org-keyword">AND</span>  nombre != <span class="org-string">'laura'</span>;
</pre>
</div></li>

<li><p>
Titulo de las peliculas del pais que menos cines tiene
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> titulo
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  c_pais = (
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  cines = (
           <span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span>(cines)
           <span class="org-keyword">FROM</span>   paises
         )
       );
</pre>
</div></li>

<li><p>
Codigo de la peliculas que se alquilo la primera vez
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_peli
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  fecha = (
         <span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span>(fecha)
         <span class="org-keyword">FROM</span>   alquiler
       );
</pre>
</div></li>

<li><p>
Codigo del socio que realizo el alquiler mas barato
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> c_socio
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  total = (
         <span class="org-keyword">SELECT</span> <span class="org-builtin">MIN</span>(total)
         <span class="org-keyword">FROM</span>   alquiler
       );
</pre>
</div></li>

<li><p>
Cuantas peliculas tenemos en los diferentes formatos
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   <span class="org-builtin">COUNT</span>(formato), formato
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> formato;
</pre>
</div></li>

<li><p>
Listado con el numero de alquileres realizados los diferentes años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   substr(fecha, 7, 2), <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>     alquiler
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> substr(fecha, 7, 2)
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> substr(fecha, 7, 2);
</pre>
</div></li>

<li><p>
Listado de los precios de las peliculas mas caras en los
diferentes años
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   anno, <span class="org-builtin">MAX</span>(precio)
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> anno
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> anno;
</pre>
</div></li>

<li><p>
Listado con el total que hemos facturada los distintos años,
alquilando peliculas
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   substr(fecha, 7, 2), <span class="org-builtin">SUM</span>(total)
<span class="org-keyword">FROM</span>     alquiler
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> substr(fecha, 7, 2)
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> substr(fecha, 7, 2);
</pre>
</div></li>

<li><p>
Cuantos DVDs españoles hay?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   peliculas
<span class="org-keyword">WHERE</span>  formato = <span class="org-string">'DVD'</span>
  <span class="org-keyword">and</span>  c_pais = (
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  nombre_pais = <span class="org-string">'Espa&#241;a'</span>
      );
</pre>
</div></li>

<li><p>
Listado con las diferencias familias socias (1er apellido) junto
con el numero de integrantes que tiene cada familia.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ape1, <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>     socios
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ape1
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> ape1;
</pre>
</div></li>

<li><p>
Listado con los diferentes titulos de peliculas que se han ido
produciendo los diferentes años.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   anno, titulo
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> anno, titulo;
</pre>
</div></li>

<li><p>
Listado con el titulo de las peliculas junto con el nombre de pais
al que pertenece.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   pe.titulo, pa.nombre_pais
<span class="org-keyword">FROM</span>     peliculas pe, paises pa
<span class="org-keyword">WHERE</span>    pe.c_pais = pa.c_pais
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> pe.titulo;
</pre>
</div></li>

<li><p>
Listado con los titulos de las peliculas que se han alquildado
junto con la fecha en que se alquilo
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   a.fecha, p.titulo
<span class="org-keyword">FROM</span>     peliculas p, alquiler a
<span class="org-keyword">WHERE</span>    p.c_peli = a.c_peli
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> a.fecha;
</pre>
</div></li>

<li><p>
Nombre de los socios que no han visto ninguna de Torrente.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   nombre, ape1
<span class="org-keyword">FROM</span>     socios
<span class="org-keyword">WHERE</span>    c_socio <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
           <span class="org-keyword">SELECT</span> c_socio
           <span class="org-keyword">FROM</span>   alquiler
           <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> (
                    <span class="org-keyword">SELECT</span> c_peli
                    <span class="org-keyword">FROM</span>   peliculas
                    <span class="org-keyword">WHERE</span>  titulo <span class="org-keyword">LIKE</span> <span class="org-string">'Torrente%'</span>
                  )
         )
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre;
</pre>
</div></li>

<li><p>
Nombre de los socios que alquilaron el año pasado.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   s.nombre, s.ape1
<span class="org-keyword">FROM</span>     socios s, alquiler a
<span class="org-keyword">WHERE</span>    s.c_socio = a.c_socio
  <span class="org-keyword">AND</span>    SUBSTR(a.fecha, 7, 2) = SUBSTR(SYSDATE, 7, 2) - 1
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> a.nombre;
</pre>
</div></li>

<li><p>
Nombre de los paises que no alquilan sus peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   nombre_pais
<span class="org-keyword">FROM</span>     paises
<span class="org-keyword">WHERE</span>    c_pais <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
           <span class="org-keyword">SELECT</span> c_pais
           <span class="org-keyword">FROM</span>   peliculas
           <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> (
                    <span class="org-keyword">SELECT</span> c_peli
                    <span class="org-keyword">FROM</span>   alquiler
                  )
         )
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre_pais;
</pre>
</div></li>

<li><p>
Nombre y apellidos de los socios que alquilan peliculas españolas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre, ape1
<span class="org-keyword">FROM</span>   socios
<span class="org-keyword">WHERE</span>  c_socio <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_socio
         <span class="org-keyword">FROM</span>   alquiler
         <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_peli
                  <span class="org-keyword">FROM</span>   peliculas
                  <span class="org-keyword">WHERE</span>  c_pais = (
                           <span class="org-keyword">SELECT</span> c_pais
                           <span class="org-keyword">FROM</span>   paises
                           <span class="org-keyword">WHERE</span>  nombre_pais = <span class="org-string">'Espa&#241;a'</span>
                         )
                )
       )
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> nombre;
</pre>
</div></li>

<li><p>
Cuantos socios han alquilado algun DVD?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(<span class="org-keyword">DISTINCT</span> c_socio)
<span class="org-keyword">FROM</span>   alquiler
<span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_peli
         <span class="org-keyword">FROM</span>   peliculas
         <span class="org-keyword">WHERE</span>  formato = <span class="org-string">'DVD'</span>
       );
</pre>
</div></li>

<li><p>
Cuantos paises tienen mas cines que la media de los paises?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(c_pais)
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  cines &gt; (
         <span class="org-keyword">SELECT</span> <span class="org-builtin">AVG</span>(cines)
         <span class="org-keyword">FROM</span>   paises
       );
</pre>
</div></li>

<li><p>
Nombre de los clientes que no han pedido nada.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
       );
</pre>
</div></li>

<li><p>
Cuantos pedidos se hicieron en 2017.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(idped)
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span>  fped <span class="org-keyword">like</span> <span class="org-string">'__/__/17'</span>;
</pre>
</div></li>

<li><p>
Nombre de los clientes que no son ni de Madrid ni de Toledo.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  ciudad != <span class="org-string">'MADRID'</span>
  <span class="org-keyword">AND</span>  ciudad != <span class="org-string">'TOLEDO'</span>;
</pre>
</div></li>

<li><p>
Descripcion de los articulos que se han vendido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   detalle
       );
</pre>
</div></li>

<li><p>
Descripcion del articulo mas caro.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  precio = (
         <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(precio)
         <span class="org-keyword">FROM</span>   articulo
       );
</pre>
</div></li>

<li><p>
Cuantos pedidos nos hacen entre madrileños y toledanos?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(idped)
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   cliente
         <span class="org-keyword">WHERE</span>  ciudad = <span class="org-string">'MADRID'</span>
            <span class="org-keyword">OR</span>  ciudad = <span class="org-string">'TOLEDO'</span>
       );
</pre>
</div></li>

<li><p>
Cuantos pedidos se hacen en la segunda quincena del mes?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(idped)
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span>  SUBSTR(fped, 1, 2) &gt; 15;
</pre>
</div></li>

<li><p>
Listado de las ciudades con el numero de clientes que tenemos en
cada provincia.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ciudad, <span class="org-builtin">COUNT</span>(idcli)
<span class="org-keyword">FROM</span>     cliente
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ciudad;
</pre>
</div></li>

<li><p>
Listado con los nombres de los clientes junto con el numero de
pedidos que nos han hecho.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   c.nombre, <span class="org-builtin">COUNT</span>(p.idped)
<span class="org-keyword">FROM</span>     cliente c, pedido p
<span class="org-keyword">WHERE</span>    c.idcli = p.idcli
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c.nombre;
</pre>
</div></li>

<li><p>
Que come Ana Kurnicova.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   detalle
         <span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> idped
                  <span class="org-keyword">FROM</span>   pedido
                  <span class="org-keyword">WHERE</span>  idcli = (
                           <span class="org-keyword">SELECT</span> idcli
                           <span class="org-keyword">FROM</span>   cliente
                           <span class="org-keyword">WHERE</span>  nombre = <span class="org-string">'ANA KURNICOVA'</span>
                         )
                )
       );
</pre>
</div></li>

<li><p>
Listado de los articulos que vendemos junto con la cantidad que
vendemos de ellos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   a.descrip, <span class="org-builtin">SUM</span>(d.cantidad)
<span class="org-keyword">FROM</span>     articulo a, detalle d
<span class="org-keyword">WHERE</span>    a.idart = d.idart
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> a.descrip
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> a.descrip;
</pre>
</div></li>

<li><p>
Que capital tenemos entre corderos y hamburguesas en el almacen?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(stock * precio)
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  descrip <span class="org-keyword">IN</span> (
         <span class="org-string">'CORDERO'</span>,
         <span class="org-string">'HAMBURGUESA'</span>
       );
</pre>
</div></li>

<li><p>
Nombre de los clientes que no comen salchichas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> idped
                  <span class="org-keyword">FROM</span>   detalle
                  <span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> (
                           <span class="org-keyword">SELECT</span> idart
                           <span class="org-keyword">FROM</span>   articulo
                           <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'SALCHICHAS'</span>
                         )
                )
       );
</pre>
</div></li>

<li><p>
Cuantas paellas se comen en Toledo?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(cantidad)
<span class="org-keyword">FROM</span>   detalle
<span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idped
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> idcli
                  <span class="org-keyword">FROM</span>   cliente
                  <span class="org-keyword">WHERE</span>  ciudad = <span class="org-string">'TOLEDO'</span>
                )
       )
  <span class="org-keyword">AND</span>  idart = (
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'PAELLA'</span>
       );
</pre>
</div></li>

<li><p>
Listado con el idped junto con el importe del pedido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   d.idped, <span class="org-builtin">SUM</span>(d.cantidad * a.precio)
<span class="org-keyword">FROM</span>     detalle d, articulo a
<span class="org-keyword">WHERE</span>    d.idart = a.idart
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> d.idped;
</pre>
</div></li>

<li><p>
Listado con las ciudades y el numero de clientes de cada ciudad.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ciudad, <span class="org-builtin">COUNT</span>(idcli)
<span class="org-keyword">FROM</span>     cliente
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ciudad;
</pre>
</div></li>

<li><p>
Nombre de las ciudades en las que tenemos mas de 2 clientes.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   ciudad
<span class="org-keyword">FROM</span>     cliente
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> ciudad
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(idcli) &gt; 2;
</pre>
</div></li>

<li><p>
En que formatos tenemos mas de 10 peliculas?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   formato
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> formato
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(c_peli) &gt; 10;
</pre>
</div></li>

<li><p>
Titulo de las peliculas que hemos alquilado mas de una vez.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   titulo
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">WHERE</span>    c_peli <span class="org-keyword">IN</span> (
           <span class="org-keyword">SELECT</span>   c_peli
           <span class="org-keyword">FROM</span>     alquiler
           <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_peli
           <span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(c_socio) &gt; 1
         );
</pre>
</div></li>

<li><p>
Que paises producen menos de 3 peliculas?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   pa.nombre_pais
<span class="org-keyword">FROM</span>     peliculas pe, paises pa
<span class="org-keyword">WHERE</span>    pe.c_pais = pa.c_pais
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> pa.nombre_pais
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(pe.c_peli) &lt; 3;
</pre>
</div></li>

<li><p>
Nombre de los socios que han alquilado mas de 2 peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   s.nombre
<span class="org-keyword">FROM</span>     socios s, alquiler a
<span class="org-keyword">WHERE</span>    s.c_socio = a.c_socio
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> s.nombre
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(a.c_peli) &gt; 2;
</pre>
</div></li>

<li><p>
Poner a oferta todas las peliculas anteriores a 2010.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> peliculas
<span class="org-keyword">SET</span>    oferta = <span class="org-string">'S'</span>
<span class="org-keyword">WHERE</span>  anno &lt; 2010;
</pre>
</div></li>

<li><p>
Rebajar el PRECIO de todas las peliculas un 25%.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> peliculas
<span class="org-keyword">SET</span>    precio = precio - precio * 25/100;
</pre>
</div></li>

<li><p>
Dia sin IVA. Quitar el IVA a todas las peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> peliculas
<span class="org-keyword">SET</span>    precio = precio / 121 * 100;
</pre>
</div></li>

<li><p>
Poner a 1 euro todas las peliculas españolas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> peliculas
<span class="org-keyword">SET</span>    precio = 1
<span class="org-keyword">WHERE</span>  c_pais <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   paises
         <span class="org-keyword">WHERE</span>  nombre_pais <span class="org-keyword">LIKE</span> <span class="org-string">'Espa&#241;a'</span>
       );
</pre>
</div></li>

<li><p>
Listado con los nombres de socios junto con el titulo de la
pelicula mal alquilada.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> s.nombre, p.titulo
<span class="org-keyword">FROM</span>   socios s, peliculas p, alquiler a
<span class="org-keyword">WHERE</span>  s.c_socio = a.c_socio
  <span class="org-keyword">AND</span>  a.c_peli = p.c_peli
  <span class="org-keyword">AND</span>  a.total != a.ndias * p.precio;
</pre>
</div></li>

<li><p>
Listado con los alquileres con el precio cobrado junto con el
precio que se deberia haber cobrado.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> p.titulo, a.total "Cobrado", a.ndias * p.precio "Precio correcto"
<span class="org-keyword">FROM</span>   peliculas p, alquiler a
<span class="org-keyword">WHERE</span>  a.c_peli = p.c_peli
  <span class="org-keyword">AND</span>  a.total != a.ndias * p.precio;
</pre>
</div></li>

<li><p>
Actualizar bien la base de datos y poner el valor correcto de
TOTAL.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> alquiler a
<span class="org-keyword">SET</span>    total = ndias * (
         <span class="org-keyword">SELECT</span> precio
         <span class="org-keyword">FROM</span>   peliculas p
         <span class="org-keyword">WHERE</span>  p.c_peli = a.c_peli
       );
</pre>
</div></li>

<li><p>
Listado con todos los nombres de los socios junto con el total que
se han gastado en el videoclub.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre, (
         <span class="org-keyword">SELECT</span> NVL(<span class="org-builtin">SUM</span>(total), 0)
         <span class="org-keyword">FROM</span> alquiler a
         <span class="org-keyword">WHERE</span> a.c_socio = s.c_socio
       ) "Total gastado"
<span class="org-keyword">FROM</span>   socios s;
</pre>
</div></li>

<li><p>
Cual es el pais que mas peliculas ha producido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre_pais
<span class="org-keyword">FROM</span>   paises
<span class="org-keyword">WHERE</span>  c_pais = (
         <span class="org-keyword">SELECT</span>   c_pais
         <span class="org-keyword">FROM</span>     peliculas
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_pais
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(c_pais) = (
                    <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(<span class="org-builtin">count</span>)
                    <span class="org-keyword">FROM</span> (
                     <span class="org-keyword">SELECT</span>   <span class="org-builtin">COUNT</span>(c_pais) <span class="org-builtin">count</span>
                     <span class="org-keyword">FROM</span>     peliculas
                     <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_pais
                   )
                 )
       );
</pre>
</div></li>

<li><p>
Quitar 100 cines a los paises que no alquilan sus peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> paises p
<span class="org-keyword">SET</span>    cines = cines - 100
<span class="org-keyword">WHERE</span>  c_pais <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_pais
         <span class="org-keyword">FROM</span>   peliculas
         <span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_peli
                  <span class="org-keyword">FROM</span>   alquiler
                )
       );
</pre>
</div></li>

<li><p>
En que formato tenemos mas peliculas.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   formato
<span class="org-keyword">FROM</span>     peliculas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> formato
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(formato) = (
           <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(<span class="org-builtin">count</span>)
           <span class="org-keyword">FROM</span> (
             <span class="org-keyword">SELECT</span>   <span class="org-builtin">COUNT</span>(formato) <span class="org-builtin">count</span>
             <span class="org-keyword">FROM</span>     peliculas
             <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> formato
           )
         );
</pre>
</div></li>

<li><p>
Poner en oferta solo aquellas peliculas que no se alquilen.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> peliculas
<span class="org-keyword">SET</span>    oferta = <span class="org-string">'S'</span>
<span class="org-keyword">WHERE</span>  c_peli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_peli
         <span class="org-keyword">FROM</span>   alquiler
       );
</pre>
</div></li>

<li><p>
Escribir correctamente los nombres de los socios.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> socios
<span class="org-keyword">SET</span>    nombre = INITCAP(nombre),
       ape1 = INITCAP(ape1),
       ape2 = INITCAP(ape2);
</pre>
</div></li>

<li><p>
Añadir a la tabla socios el atributo GASTADO (numerico de 6):
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> <span class="org-function-name">socios</span>
<span class="org-keyword">ADD</span>   gastado <span class="org-keyword">NUMBER</span>(6);
</pre>
</div></li>

<li><p>
Poner el campo GASTADO con el valor correcto con el total gastado
de cada socio.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> socios s
<span class="org-keyword">SET</span>    gastado = (
         <span class="org-keyword">SELECT</span> NVL(<span class="org-builtin">SUM</span>(ndias * (
                  <span class="org-keyword">SELECT</span> precio
                  <span class="org-keyword">FROM</span>   peliculas p
                  <span class="org-keyword">WHERE</span>  p.c_peli = a.c_peli
                )), 0)
         <span class="org-keyword">FROM</span>   alquiler a
         <span class="org-keyword">WHERE</span>  a.c_socio = s.c_socio
       );
</pre>
</div></li>

<li><p>
Cual es el valor en euros de todo lo que tenemos en stock?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(precio * stock)
<span class="org-keyword">FROM</span>   articulo;
</pre>
</div></li>

<li><p>
Bajar un 25% el precio de los articulos que se venden.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> articulo a
<span class="org-keyword">SET</span>    precio = precio * 0.75
<span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   detalle
       );
</pre>
</div></li>

<li><p>
Que articulos se piden mas de una vez en el mismo pedido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  idart <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idart
         <span class="org-keyword">FROM</span>   detalle
         <span class="org-keyword">WHERE</span>  cantidad &gt; 1
       );
</pre>
</div></li>

<li><p>
Cual fue la ultima vez que se vendio CORDERO.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(fped)
<span class="org-keyword">FROM</span>   pedido
<span class="org-keyword">WHERE</span> idped <span class="org-keyword">IN</span> (
        <span class="org-keyword">SELECT</span> idped
        <span class="org-keyword">FROM</span>   detalle
        <span class="org-keyword">WHERE</span>  idart = (
                 <span class="org-keyword">SELECT</span> idart
                 <span class="org-keyword">FROM</span>   articulo
                 <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'CORDERO'</span>
               )
      );
</pre>
</div></li>

<li><p>
Que codigos de pedido incluyen mas de 2 articulos diferentes.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   idped
<span class="org-keyword">FROM</span>     detalle
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idped
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(idart) &gt; 2;
</pre>
</div></li>

<li><p>
Nombre de los clientes que pagan despues de 10 dias de haber
hecho el pedido.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  ffac - fped &gt; 10
       );
</pre>
</div></li>

<li><p>
Cuantos clientes se llaman MARIA de nombre?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(idcli)
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  nombre <span class="org-keyword">like</span> <span class="org-string">'MARIA%'</span>;
</pre>
</div></li>

<li><p>
Quien hizo el pedido con mas articulos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli = (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idped = (
                  <span class="org-keyword">SELECT</span>   idped
                  <span class="org-keyword">FROM</span>     detalle
                  <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idped
                  <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(cantidad) = (
                             <span class="org-keyword">SELECT</span>   <span class="org-builtin">MAX</span>(<span class="org-builtin">SUM</span>(cantidad))
                             <span class="org-keyword">FROM</span>     detalle
                             <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idped
                           )
                )
       );
</pre>
</div></li>

<li><p>
Nombre del cliente que pidio mas PAELLAS.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   idcli
         <span class="org-keyword">FROM</span>     pedido p, detalle d
         <span class="org-keyword">WHERE</span>    p.idped = d.idped
           <span class="org-keyword">AND</span>    d.idart = (
                    <span class="org-keyword">SELECT</span> idart
                    <span class="org-keyword">FROM</span>   articulo
                    <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'HAMBURGUESA'</span>
                  )
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idcli
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(d.cantidad) &gt; 2
       );
</pre>
</div></li>

<li><p>
Nombre de los clientes que no han probado las ALBONDIGAS.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> idped
                  <span class="org-keyword">FROM</span>   detalle
                  <span class="org-keyword">WHERE</span>  idart = (
                           <span class="org-keyword">SELECT</span> idart
                           <span class="org-keyword">FROM</span>   articulo
                           <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'ALBONDIGAS'</span>
                         )
                )
       );
</pre>
</div></li>

<li><p>
Quien ha comido mas de dos HAMBURGUESAS.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> idcli
         <span class="org-keyword">FROM</span>   pedido
         <span class="org-keyword">WHERE</span>  idped <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span>   idped
                  <span class="org-keyword">FROM</span>     detalle
                  <span class="org-keyword">WHERE</span>    idart = (
                             <span class="org-keyword">SELECT</span> idart
                             <span class="org-keyword">FROM</span>   articulo
                             <span class="org-keyword">WHERE</span>  descrip = <span class="org-string">'HAMBURGUESA'</span>
                           )
                  <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idped
                  <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(cantidad) &gt; 2
                )
       );
</pre>
</div></li>

<li><p>
Cuantos clientes han hecho menos de 2 pedidos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(idcli)
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   idcli
         <span class="org-keyword">FROM</span>     pedido
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idcli
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(idped) &gt;= 2
       );
</pre>
</div></li>

<li><p>
Suponiendo que cuando abrimos la empresa teniamos 100 unidades de
cada articulo. Poner correctamente el valor de STOCK.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> articulo a
<span class="org-keyword">SET</span>    stock = 100 - (
         <span class="org-keyword">SELECT</span> NVL(<span class="org-builtin">SUM</span>(cantidad), 0)
         <span class="org-keyword">FROM</span>   detalle
         <span class="org-keyword">WHERE</span>  idart = a.idart
       );
</pre>
</div></li>

<li><p>
Añadir el campo GASTADO a la tabla cliente y ponerlo con el valor
correcto.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> <span class="org-function-name">cliente</span>
<span class="org-keyword">ADD</span>   gastado <span class="org-keyword">NUMBER</span>(6);
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> cliente c
<span class="org-keyword">SET</span>    gastado = (
         <span class="org-keyword">SELECT</span>   NVL(<span class="org-builtin">SUM</span>(d.cantidad * (
                    <span class="org-keyword">SELECT</span> precio
                    <span class="org-keyword">FROM</span>   articulo
                    <span class="org-keyword">WHERE</span>  idart = d.idart
                  )), 0)
         <span class="org-keyword">FROM</span>     pedido p, detalle d
         <span class="org-keyword">WHERE</span>    p.idcli = c.idcli
           <span class="org-keyword">AND</span>    p.idped = d.idped
       );
</pre>
</div></li>

<li><p>
Cuantos pedidos tienen mas de 2 articulos diferentes.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(*)
<span class="org-keyword">FROM</span>   (
         <span class="org-keyword">SELECT</span>   idped
         <span class="org-keyword">FROM</span>     detalle
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idped
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(idart) &gt; 2
       );
</pre>
</div></li>

<li><p>
Codigos de pedido con menos de 2 articulos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   idped
<span class="org-keyword">FROM</span>     detalle
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idped
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(idart) &lt; 2;
</pre>
</div></li>

<li><p>
Nombre de los clientes que han consumido menos de 2 articulos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   cliente
<span class="org-keyword">WHERE</span>  idcli <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   idcli
         <span class="org-keyword">FROM</span>     pedido p, detalle d
         <span class="org-keyword">WHERE</span>    p.idped = d.idped
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> idcli
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(cantidad) &lt; 2
       );
</pre>
</div></li>

<li><p>
Cuanto hemos facturado en el 2017?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(importe)
<span class="org-keyword">FROM</span>   ventas
<span class="org-keyword">WHERE</span>  fecha <span class="org-keyword">like</span> <span class="org-string">'__/__/17'</span>;
</pre>
</div></li>

<li><p>
Con que articulo hemos ganado mas dinero?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  c_art <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   c_art
         <span class="org-keyword">FROM</span>     ventas
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_art
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(importe) = (
                    <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(<span class="org-builtin">SUM</span>(importe))
                    <span class="org-keyword">FROM</span>   ventas
                    <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_art
                  )
       );
</pre>
</div></li>

<li><p>
Nombre de los clientes que se gastan menos de 5 euros en nuestra
tienda.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   clientes
<span class="org-keyword">WHERE</span>  c_cliente <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   c_cliente
         <span class="org-keyword">FROM</span>     ventas
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_cliente
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(importe) &gt;= 5
       );
</pre>
</div></li>

<li><p>
Actualizar el campo deuda de CLIENTE sabiendo que todos los
clientes han pagado todo menos la ultima compra que hicieron.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> clientes c
<span class="org-keyword">SET</span>    deuda = NVL((
         <span class="org-keyword">SELECT</span> importe
         <span class="org-keyword">FROM</span>   ventas
         <span class="org-keyword">WHERE</span>  c_cliente = c.c_cliente
           <span class="org-keyword">AND</span>  fecha = (
                  <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(fecha)
                  <span class="org-keyword">FROM</span>   ventas
                  <span class="org-keyword">WHERE</span>  c_cliente = c.c_cliente
                )
       ), 0);
</pre>
</div></li>

<li><p>
Cual fue el año que mas articulos vendimos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   SUBSTR(fecha, 7, 2)
<span class="org-keyword">FROM</span>     ventas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> SUBSTR(fecha, 7, 2)
<span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(importe) = (
           <span class="org-keyword">SELECT</span>   <span class="org-builtin">MAX</span>(<span class="org-builtin">SUM</span>(importe))
           <span class="org-keyword">FROM</span>     ventas
           <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> SUBSTR(fecha, 7, 2)
);
</pre>
</div></li>

<li><p>
Actualizar correctamente el campo IMPORTE DE VENTAS teniendo en
cuenta la CANTIDAD y el PRECIO.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> ventas v
<span class="org-keyword">SET</span>    importe = cantidad * (
         <span class="org-keyword">SELECT</span> precio
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_art = v.c_art
       );
</pre>
</div></li>

<li><p>
Listado con los nombres de los clientes junto con las fechas en
las que ha comprado.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   (
           <span class="org-keyword">SELECT</span> nombre
           <span class="org-keyword">FROM</span>   clientes
           <span class="org-keyword">WHERE</span>  c_cliente = v.c_cliente
         ), fecha
<span class="org-keyword">FROM</span>     ventas v
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> 1, 2
</pre>
</div></li>

<li><p>
De que provincia proceden la mayoria de los productos que
tenemos?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> provincia
<span class="org-keyword">FROM</span>   proveedor
<span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   c_provee
         <span class="org-keyword">FROM</span>     articulo
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_provee
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(stock) = (
                    <span class="org-keyword">SELECT</span>   <span class="org-builtin">MAX</span>(<span class="org-builtin">SUM</span>(stock))
                    <span class="org-keyword">FROM</span>     articulo
                    <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_provee
                  )
       );
</pre>
</div></li>

<li><p>
Si de cada articulo ganamos un 30% de su precio, cuanto hemos
ganado con los articulos de Madrid.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(importe) * 0.3 "Beneficio"
<span class="org-keyword">FROM</span>   ventas
<span class="org-keyword">WHERE</span>  c_art <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_art
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_provee
                  <span class="org-keyword">FROM</span>   proveedor
                  <span class="org-keyword">WHERE</span>  provincia = <span class="org-string">'MADRID'</span>
                )
       );
</pre>
</div></li>

<li><p>
Visualizar los 5 articulos mas baratos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> *
<span class="org-keyword">FROM</span>   (
         <span class="org-keyword">SELECT</span>   descrip
         <span class="org-keyword">FROM</span>     articulo
         <span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> precio
       )
<span class="org-keyword">WHERE</span>  rownum &lt;= 5;
</pre>
</div></li>

<li><p>
En que anio incorporamos mas clientes a nuestra empresa.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   <span class="org-string">'20'</span>||SUBSTR(f_alta, 7, 2)
<span class="org-keyword">FROM</span>     clientes
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> <span class="org-string">'20'</span>||SUBSTR(f_alta, 7, 2)
<span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(c_cliente) = (
           <span class="org-keyword">SELECT</span> <span class="org-builtin">MAX</span>(<span class="org-builtin">COUNT</span>(c_cliente))
           <span class="org-keyword">FROM</span>   clientes
           <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> SUBSTR(f_alta, 7, 2)
         );
</pre>
</div></li>

<li><p>
En que anios hemos vendido mas de 4 articulos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>   <span class="org-string">'20'</span>||SUBSTR(fecha, 7, 2)
<span class="org-keyword">FROM</span>     ventas
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> <span class="org-string">'20'</span>||SUBSTR(fecha, 7, 2)
<span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(cantidad) &gt; 4
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> 1;
</pre>
</div></li>

<li><p>
Cuantos articulos de proveedores de Toledo se han vendido
seguramente a clientes de Toledo.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> NVL(<span class="org-builtin">SUM</span>(cantidad), 0)
<span class="org-keyword">FROM</span>   ventas
<span class="org-keyword">WHERE</span>  c_art <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_art
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_provee
                  <span class="org-keyword">FROM</span>   proveedor
                  <span class="org-keyword">WHERE</span>  provincia = <span class="org-string">'TOLEDO'</span>
                )
       )
  <span class="org-keyword">AND</span>  c_cliente <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_cliente
         <span class="org-keyword">FROM</span>   clientes
         <span class="org-keyword">WHERE</span>  telefono <span class="org-keyword">LIKE</span> <span class="org-string">'925%'</span>
       );
</pre>
</div></li>

<li><p>
Poner bien el valor de deuda de los clientes. Suponiendo que
jamas nos han pagado nada.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> clientes c
<span class="org-keyword">SET</span>    deuda = NVL((
         <span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(importe)
         <span class="org-keyword">FROM</span>   ventas
         <span class="org-keyword">WHERE</span>  c_cliente = c.c_cliente
       ), 0);
</pre>
</div></li>

<li><p>
Que nombres de clientes tienen una vocal repetida.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   clientes
<span class="org-keyword">WHERE</span>  <span class="org-builtin">LOWER</span>(nombre) <span class="org-keyword">LIKE</span> <span class="org-string">'%a%a%'</span>
   <span class="org-keyword">OR</span>  <span class="org-builtin">LOWER</span>(nombre) <span class="org-keyword">LIKE</span> <span class="org-string">'%e%e%'</span>
   <span class="org-keyword">OR</span>  <span class="org-builtin">LOWER</span>(nombre) <span class="org-keyword">LIKE</span> <span class="org-string">'%i%i%'</span>
   <span class="org-keyword">OR</span>  <span class="org-builtin">LOWER</span>(nombre) <span class="org-keyword">LIKE</span> <span class="org-string">'%o%o%'</span>
   <span class="org-keyword">OR</span>  <span class="org-builtin">LOWER</span>(nombre) <span class="org-keyword">LIKE</span> <span class="org-string">'%u%u%'</span>;
</pre>
</div></li>

<li><p>
Aniadir el atributo PROCEDENCIA a articulo, que sera la misma
provincia del proveedor que lo suministra. Actualizar su valor.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> <span class="org-function-name">articulo</span>
<span class="org-keyword">ADD</span>   procedencia VARCHAR2(12);

<span class="org-keyword">UPDATE</span> articulo a
<span class="org-keyword">SET</span>    procedencia = (
         <span class="org-keyword">SELECT</span> provincia
         <span class="org-keyword">FROM</span>   proveedor
         <span class="org-keyword">WHERE</span>  c_provee = a.c_provee
       );
</pre>
</div></li>

<li><p>
Aniade el atributo RANKING a la tabla clientes y colocar el valor
correcto desde entero 1 hacia delante. Desde el q mas gasta al q
menos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> <span class="org-function-name">clientes</span>
<span class="org-keyword">ADD</span>   ranking <span class="org-keyword">NUMBER</span>(3);

<span class="org-keyword">UPDATE</span> clientes c
<span class="org-keyword">SET</span>    ranking = (
         <span class="org-keyword">SELECT</span> fila
         <span class="org-keyword">FROM</span> (
                <span class="org-keyword">SELECT</span>   c_cliente, rownum <span class="org-keyword">as</span> fila
                <span class="org-keyword">FROM</span>     (
                           <span class="org-keyword">SELECT</span>   c_cliente
                           <span class="org-keyword">FROM</span>     clientes c
                           <span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> (
                                      <span class="org-keyword">SELECT</span> <span class="org-builtin">SUM</span>(importe)
                                      <span class="org-keyword">FROM</span> ventas
                                      <span class="org-keyword">WHERE</span> c_cliente = c.c_cliente
                                    ), nombre
                         )
              )
         <span class="org-keyword">WHERE</span> c_cliente = c.c_cliente
       );
</pre>
</div></li>

<li><p>
Insertar un cliente de Toledo. Insertar 10 ventas de proveedores
de Toledo a clientes de Toledo.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">INSERT</span> <span class="org-keyword">INTO</span> clientes
<span class="org-keyword">VALUES</span> (
  400,
  <span class="org-string">'Pepino'</span>,
  0,
  925123456,
  <span class="org-string">'04/03/22'</span>,
  11
);

<span class="org-keyword">INSERT</span> <span class="org-keyword">INTO</span> ventas
<span class="org-keyword">SELECT</span> 100 + rownum, art, cant, prec, fecha, cliente
<span class="org-keyword">FROM</span>   (
         <span class="org-keyword">SELECT</span> a.c_art <span class="org-keyword">as</span> art, rownum + 1 <span class="org-keyword">as</span> cant,
                rownum + 1 * a.precio <span class="org-keyword">as</span> prec,
                sysdate <span class="org-keyword">as</span> fecha, c.c_cliente <span class="org-keyword">as</span> cliente
         <span class="org-keyword">FROM</span>   clientes c, articulo a
         <span class="org-keyword">WHERE</span>  c.telefono <span class="org-keyword">LIKE</span> <span class="org-string">'925%'</span>
           <span class="org-keyword">AND</span>  a.c_provee <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_provee
                  <span class="org-keyword">FROM</span>   proveedor
                  <span class="org-keyword">WHERE</span>  provincia = <span class="org-string">'TOLEDO'</span>
                )
         <span class="org-keyword">UNION</span>
         <span class="org-comment-delimiter">-- </span><span class="org-comment">Copy paste del de arriba</span>
         <span class="org-comment-delimiter">-- </span><span class="org-comment">(hay solo 4 ventas necesito 10)</span>
         <span class="org-keyword">SELECT</span> a.c_art <span class="org-keyword">as</span> art, rownum + 1 <span class="org-keyword">as</span> cant,
                rownum + 1 * a.precio <span class="org-keyword">as</span> prec,
                sysdate <span class="org-keyword">as</span> fecha, c.c_cliente <span class="org-keyword">as</span> cliente
         <span class="org-keyword">FROM</span>   clientes c, articulo a
         <span class="org-keyword">WHERE</span>  c.telefono <span class="org-keyword">LIKE</span> <span class="org-string">'925%'</span>
           <span class="org-keyword">AND</span>  a.c_provee <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_provee
                  <span class="org-keyword">FROM</span>   proveedor
                  <span class="org-keyword">WHERE</span>  provincia = <span class="org-string">'TOLEDO'</span>
                )
         <span class="org-keyword">UNION</span>
         <span class="org-comment-delimiter">-- </span><span class="org-comment">Copy paste del de arriba</span>
         <span class="org-comment-delimiter">-- </span><span class="org-comment">(hay solo 4 ventas necesito 10)</span>
         <span class="org-keyword">SELECT</span> a.c_art <span class="org-keyword">as</span> art, rownum + 1 <span class="org-keyword">as</span> cant,
                rownum + 1 * a.precio <span class="org-keyword">as</span> prec,
                sysdate <span class="org-keyword">as</span> fecha, c.c_cliente <span class="org-keyword">as</span> cliente
         <span class="org-keyword">FROM</span>   clientes c, articulo a
         <span class="org-keyword">WHERE</span>  c.telefono <span class="org-keyword">LIKE</span> <span class="org-string">'925%'</span>
           <span class="org-keyword">AND</span>  a.c_provee <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_provee
                  <span class="org-keyword">FROM</span>   proveedor
                  <span class="org-keyword">WHERE</span>  provincia = <span class="org-string">'TOLEDO'</span>
                )
       )
<span class="org-keyword">WHERE</span>  rownum &lt; 11;
</pre>
</div></li>

<li><p>
Borrar las tuplas de los proveedores que venden menos de 2
articulos (borrar tuplas de otras tablas si son necesarias).
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">DELETE</span> <span class="org-keyword">FROM</span> ventas v
<span class="org-keyword">WHERE</span>  c_art <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_art
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span>      c_provee
                  <span class="org-keyword">FROM</span>        articulo
                  <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span>    c_provee
                  <span class="org-keyword">HAVING</span> <span class="org-builtin">COUNT</span>(c_art) &lt; 2
                )
       );

<span class="org-keyword">DELETE</span> <span class="org-keyword">FROM</span> articulo a
<span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>      c_provee
         <span class="org-keyword">FROM</span>        articulo
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span>    c_provee
         <span class="org-keyword">HAVING</span> <span class="org-builtin">COUNT</span>(c_art) &lt; 2
       );

<span class="org-keyword">DELETE</span> <span class="org-keyword">FROM</span> proveedor p
<span class="org-keyword">WHERE</span>  (
         <span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(c_art)
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_provee = p.c_provee
       ) &lt; 2;
</pre>
</div></li>

<li><p>
Cuantos articulos tenemos de proveedores de que no son ni de
MADRID ni TOLEDO ni SEVILLA?
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(c_art)
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_provee
         <span class="org-keyword">FROM</span>   proveedor
         <span class="org-keyword">WHERE</span>  provincia <span class="org-keyword">IN</span> (
                  <span class="org-string">'MADRID'</span>,
                  <span class="org-string">'TOLEDO'</span>,
                  <span class="org-string">'SEVILLA'</span>
                )
       )
</pre>
</div></li>

<li><p>
Sube un 15% de los articulos y cambia los valores de ventas para
que sean correctos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">UPDATE</span> articulo a
<span class="org-keyword">SET</span>    precio = precio * 1.15;

<span class="org-keyword">UPDATE</span> ventas v
<span class="org-keyword">SET</span>    importe = cantidad * (
         <span class="org-keyword">SELECT</span> precio
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_art = v.c_art
       );
</pre>
</div></li>

<li><p>
Visualizar la descripcion del articulo mas barato que no se
vende.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   (
         <span class="org-keyword">SELECT</span>   descrip
         <span class="org-keyword">FROM</span>     articulo
         <span class="org-keyword">WHERE</span>    c_art <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
                    <span class="org-keyword">SELECT</span> c_art
                    <span class="org-keyword">FROM</span>   ventas
                  )
         <span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> precio
       )
<span class="org-keyword">WHERE</span>  rownum = 1;
</pre>
</div></li>

<li><p>
Nombre de los clientes que han comprado mas de 14 productos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   clientes
<span class="org-keyword">WHERE</span>  c_cliente <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   c_cliente
         <span class="org-keyword">FROM</span>     ventas
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_cliente
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(cantidad) &gt; 14
       )
</pre>
</div></li>

<li><p>
Descripcion de los articulos que se han vendido menos de 10
unidades.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> descrip
<span class="org-keyword">FROM</span>   articulo
<span class="org-keyword">WHERE</span>  c_art <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   c_art
         <span class="org-keyword">FROM</span>     ventas
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_art
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">SUM</span>(cantidad) &gt;= 10
       )
</pre>
</div></li>

<li><p>
Que clientes compran mas veces que la media, independiente de las
cantidades.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> nombre
<span class="org-keyword">FROM</span>   clientes
<span class="org-keyword">WHERE</span>  c_cliente <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span>   c_cliente
         <span class="org-keyword">FROM</span>     ventas
         <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_cliente
         <span class="org-keyword">HAVING</span>   <span class="org-builtin">COUNT</span>(c_factura) &gt; (
                    <span class="org-keyword">SELECT</span>   <span class="org-builtin">AVG</span>(<span class="org-builtin">COUNT</span>(c_factura))
                    <span class="org-keyword">FROM</span>     ventas
                    <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> c_cliente
                  )
       );
</pre>
</div></li>

<li><p>
Cuantos proveedores no venden sus articulos.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> <span class="org-builtin">COUNT</span>(c_provee)
<span class="org-keyword">FROM</span>   proveedor
<span class="org-keyword">WHERE</span>  c_provee <span class="org-keyword">NOT</span> <span class="org-keyword">IN</span> (
         <span class="org-keyword">SELECT</span> c_provee
         <span class="org-keyword">FROM</span>   articulo
         <span class="org-keyword">WHERE</span>  c_art <span class="org-keyword">IN</span> (
                  <span class="org-keyword">SELECT</span> c_art
                  <span class="org-keyword">FROM</span>   ventas
                )
       )
</pre>
</div></li>
</ol>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Alberto Robles Gomez</p>
<p class="date">Created: 2022-03-23 Wed 17:52</p>
</div>
</body>
</html>
